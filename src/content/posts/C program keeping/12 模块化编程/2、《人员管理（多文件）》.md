## [1. 编译时注意点](https://doc.itprojects.cn/0004.zhishi.c/0002.doc/index.html#/11.1.c.h?id=_1-%e7%bc%96%e8%af%91%e6%97%b6%e6%b3%a8%e6%84%8f%e7%82%b9)

![[_attachments/Pasted image 20250114144345.png]]

## [2. 源代码](https://doc.itprojects.cn/0004.zhishi.c/0002.doc/index.html#/11.1.c.h?id=_2-%e6%ba%90%e4%bb%a3%e7%a0%81)

`PersonManageSys.c`代码如下

```c
#include <stdio.h>

#include "menu.h"
#include "custom.h"
#include "link.h"


int main() {

    // 定义变量，用来存储链表的头
    struct stu *head = NULL;

    // 1. 打印菜单
    print_menu();

    // 2. 选择功能
    int option = 0;
    while (1) {
        printf("请输入要执行的功能: ");
        scanf("%d", &option);
        switch (option) {
            case 1:
                add_new_student(&head);
                break;
            case 2:
                modify_student(head);
                break;
            case 3:
                search_student(head);
                break;
            case 4:
                delete_student(&head);
                break;
            case 5:
                print_all_stu(head);
                break;
            case 6:
                free_link(head);  // 释放整个链表
                return 0;
            default:
                printf("输入有误，请重新输入...\n");
        }
    }

    return 0;
}
```

`link.c`代码如下

```
#include "stdlib.h"
#include "stdio.h"

#include "custom.h"

int g_num=100;

extern void add_new_student(struct stu **head) {
    // 创建1个新空间，用来存放学生的信息
    struct stu *new_stu = (struct stu *) malloc(sizeof(struct stu));

    // 给这个新空间中 写入新的数据
    printf("请输入新学生的学号:");
    scanf("%d", &(new_stu->num));
    new_stu->next = NULL;

    // 添加新学生到原链表的末尾
    if (*head == NULL) {
        *head = new_stu;
    } else {
        // 找到链表中，最后1个元素，然后将新的学生添加到模块
        struct stu *p = *head;
        while (p->next != NULL) {
            p = p->next;
        }
        p->next = new_stu;
    }
}

void print_all_stu(struct stu *head) {
    while (head != NULL) {
        printf("学生学号:%d\n", head->num);
        head = head->next;
    }
}

void modify_student(struct stu *head) {
    printf("请输入要修改的学生学号:");
    int num;
    scanf("%d", &num);

    // 遍历链表，查询是否存在这个学生学号
    int new_num;
    int flag = 0;
    while (head != NULL) {
        if (head->num == num) {
            // 找到需要修改的学生
            printf("OK，已找到学号%d, 请输入新的学生学号:", num);
            scanf("%d", &new_num);
            head->num = new_num;
            flag = 1;  // 用1标示已找到，用0标示未找到
            break;
        }

        head = head->next;
    }

    if (flag == 0) {
        printf("SORRY, 没有找到学号%d\n", num);
    }
}


void search_student(struct stu *head) {
    printf("请输入要查询的学生学号:");
    int num;
    scanf("%d", &num);

    // 遍历链表，查询是否存在这个学生学号
    int flag = 0;
    while (head != NULL) {
        if (head->num == num) {
            // 找到需要修改的学生
            printf("OK，已找到学号%d\n", num);
            flag = 1;  // 用1标示已找到，用0标示未找到
            break;
        }

        head = head->next;
    }

    if (flag == 0) {
        printf("SORRY, 没有找到学号%d\n", num);
    }
}

void delete_student(struct stu **head) {
    printf("请输入要删除的学生学号:");
    int num;
    scanf("%d", &num);

    // 遍历链表，查询是否存在这个学生学号
    int flag = 0;
    struct stu *p1, *p2 = NULL;
    p1 = *head;

    while (p1 != NULL) {
        if (p1->num == num) {
            // 找到需要删除的学生
            printf("OK，已找到学号%d\n", num);
            flag = 1;  // 用1标示已找到，用0标示未找到

            // 如果要删除的是 第1个节点
            if (p1 == *head) {
                *head = p1->next;
            } else {
                p2->next = p1->next;
            }

            // 注意，要将malloc的内存空间，释放
            free(p1);

            break;
        }

        p2 = p1;
        p1 = p1->next;
    }

    if (flag == 0) {
        printf("SORRY, 没有找到要删除的学号%d\n", num);
    }
}

void free_link(struct stu *head) {
    struct stu *temp;
    while (head != NULL) {
        temp = head;
        head = head->next;
        free(temp);
    }
}
```

`link.h`代码如下：

```
//
// Created by wangmingdong on 2023/6/12.
//

#include "custom.h"

#ifndef C_PROJECT8_LINK_H
#define C_PROJECT8_LINK_H

extern void add_new_student(struct stu **head);
extern void print_all_stu(struct stu *head);
extern void modify_student(struct stu *head);
extern void search_student(struct stu *head);
extern void delete_student(struct stu **head);
extern void free_link(struct stu *head);

#endif //C_PROJECT8_LINK_H
```

`menu.c`代码如下：

```
//
// Created by wangmingdong on 2023/6/12.
//

#include "stdio.h"

void print_menu() {
    printf("-------------菜单------------\n");
    printf("1. 添加新学生信息\n");
    printf("2. 修改学生信息\n");
    printf("3. 查询学生信息\n");
    printf("4. 删除学生信息\n");
    printf("5. 打印所有学生信息\n");
    printf("6. 退出系统\n");
    printf("----------------------------\n");
}
```

`menu.h`代码如下：

```
//
// Created by wangmingdong on 2023/6/12.
//

#ifndef C_PROJECT8_MENU_H
#define C_PROJECT8_MENU_H

void print_menu();

#endif //C_PROJECT8_MENU_H
```

`custom.h`代码如下：

```
//
// Created by wangmingdong on 2023/6/12.
//

#ifndef C_PROJECT8_CUSTOM_H
#define C_PROJECT8_CUSTOM_H

struct stu {
    int num;
    struct stu *next;
};


#endif //C_PROJECT8_CUSTOM_H
```
